(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[971],{5702:function(e,s,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/new",function(){return a(4791)}])},3247:function(e,s,a){"use strict";a.d(s,{Z:function(){return Navbar}});var t=a(5893),n=a(1664),l=a.n(n);function Navbar(){return(0,t.jsxs)("nav",{className:"p-4 border-b flex justify-between items-center",children:[(0,t.jsx)(l(),{href:"/",className:"text-xl font-bold",children:"OnlyFries"}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsx)(l(),{href:"/",className:"hover:text-yellow-500",children:"Home"}),(0,t.jsx)(l(),{href:"/new",className:"hover:text-yellow-500",children:"New Post"})]})]})}},2497:function(e,s,a){"use strict";a.d(s,{db:function(){return m},t:function(){return d}});var t=a(3977),n=a(2370),l=a(9828),r=a(9362),i=a(9744);let o={apiKey:"AIzaSyBt9tzisH1lRcivPB4wh7D2WzHxgkp9v4Y",authDomain:"onlyfries-app.firebaseapp.com",projectId:"onlyfries-app",storageBucket:"onlyfries-app.firebasestorage.app",messagingSenderId:"933935883918",appId:"1:933935883918:web:66bb3a09f5981791918bdf",measurementId:"G-RWD456SCHN"},c=(0,t.ZF)(o),m=(0,l.ad)(c,"onlyfries-app");(0,n.v0)(c);let d=(0,r.cF)(c);(0,i.Gb)().then(e=>e&&(0,i.IH)(c)),console.log("Firebase initialized with config:",{projectId:o.projectId,authDomain:o.authDomain})},4791:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return NewPost}});var t=a(5893),n=a(3247),l=a(7294),r=a(2497),i=a(9362),o=a(9828),c=a(1163);function PostForm(){let[e,s]=(0,l.useState)(null),[a,n]=(0,l.useState)(""),[m,d]=(0,l.useState)(!1),[u,p]=(0,l.useState)(""),[h,g]=(0,l.useState)({locationName:"",type:"",description:"",length:5,thickness:5,crispiness:5,saltiness:5,darkness:5,overall:5}),[x,b]=(0,l.useState)([]),[f,N]=(0,l.useState)(!1),w=(0,l.useRef)(null),j=(0,c.useRouter)();(0,l.useEffect)(()=>{if(window.google){let e=new window.google.maps.LatLngBounds(new window.google.maps.LatLng(40.4774,-74.2591),new window.google.maps.LatLng(40.9176,-73.7004)),s=new window.google.maps.places.Autocomplete(w.current,{types:["establishment"],bounds:e,strictBounds:!0});s.addListener("place_changed",()=>{let e=s.getPlace();e.name&&(g(s=>({...s,locationName:e.name})),N(!1))})}},[]);let uploadImage=async e=>{let s=Date.now(),a=e.name.replace(/[^a-zA-Z0-9.]/g,"_").toLowerCase(),t="fries/".concat(s,"_").concat(a);console.log("Uploading image to:",t);let n=(0,i.iH)(r.t,t),l={contentType:e.type,customMetadata:{originalName:e.name,uploadTime:new Date().toISOString()}};try{let s=await (0,i.KV)(n,e,l);console.log("Upload successful:",s);let a=await (0,i.Jt)(s.ref);return console.log("Download URL:",a),a}catch(e){throw console.error("Upload error:",e),e}},handleSubmit=async s=>{if(s.preventDefault(),!e){p("Please select an image");return}d(!0),p("");try{console.log("Starting upload process...");let s=await uploadImage(e),a={locationName:h.locationName.trim(),type:h.type.trim(),description:h.description.trim(),length:Number(h.length),thickness:Number(h.thickness),crispiness:Number(h.crispiness),saltiness:Number(h.saltiness),darkness:Number(h.darkness),overall:Number(h.overall),imageUrl:s,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};if(!a.locationName||!a.type||!a.description)throw Error("Please fill in all required fields");console.log("Saving to Firestore:",a);try{let e=(0,o.hJ)(r.db,"posts"),s=await (0,o.ET)(e,a);console.log("Document written with ID:",s.id),j.push("/")}catch(e){throw console.error("Firestore write error:",{code:e.code,message:e.message,details:e}),p("Error saving post: "+(e.message||"Unknown error")),e}}catch(e){console.error("Submission error:",e),p(e.message||"Error submitting post")}finally{d(!1)}};return(0,t.jsxs)("form",{onSubmit:handleSubmit,className:"max-w-2xl mx-auto p-4",children:[u&&(0,t.jsx)("div",{className:"mb-4 p-4 bg-red-100 text-red-700 rounded",children:u}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Fries Image"}),(0,t.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{let a=e.target.files[0];if(a){if(!a.type.startsWith("image/")){p("Please upload an image file");return}if(a.size>5242880){p("Image size should be less than 5MB");return}s(a),n(URL.createObjectURL(a)),p("")}},className:"w-full p-2 border rounded",required:!0}),a&&(0,t.jsx)("img",{src:a,alt:"Preview",className:"mt-2 max-h-48 rounded"})]}),(0,t.jsxs)("div",{className:"mb-4 relative",children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Location Name"}),(0,t.jsx)("input",{ref:w,type:"text",value:h.locationName,onChange:e=>{g({...h,locationName:e.target.value}),N(!0)},className:"w-full p-2 border rounded",placeholder:"Search for a restaurant/bar",required:!0})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Fries Type"}),(0,t.jsx)("input",{type:"text",value:h.type,onChange:e=>g({...h,type:e.target.value}),className:"w-full p-2 border rounded",placeholder:"e.g., Shoestring, Curly, Waffle, etc.",required:!0})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Description"}),(0,t.jsx)("textarea",{value:h.description,onChange:e=>g({...h,description:e.target.value}),className:"w-full p-2 border rounded",rows:"3",placeholder:"Describe the fries, any special seasonings, etc.",required:!0})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Length (1-10)"}),(0,t.jsx)("input",{type:"range",min:"1",max:"10",value:h.length,onChange:e=>g({...h,length:parseInt(e.target.value)}),className:"w-full"}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:h.length})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Thickness (1-10)"}),(0,t.jsx)("input",{type:"range",min:"1",max:"10",value:h.thickness,onChange:e=>g({...h,thickness:parseInt(e.target.value)}),className:"w-full"}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:h.thickness})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Crispiness (1-10)"}),(0,t.jsx)("input",{type:"range",min:"1",max:"10",value:h.crispiness,onChange:e=>g({...h,crispiness:parseInt(e.target.value)}),className:"w-full"}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:h.crispiness})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Saltiness (1-10)"}),(0,t.jsx)("input",{type:"range",min:"1",max:"10",value:h.saltiness,onChange:e=>g({...h,saltiness:parseInt(e.target.value)}),className:"w-full"}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:h.saltiness})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Darkness (1-10)"}),(0,t.jsx)("input",{type:"range",min:"1",max:"10",value:h.darkness,onChange:e=>g({...h,darkness:parseInt(e.target.value)}),className:"w-full"}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:h.darkness})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Overall Rating (1-10)"}),(0,t.jsx)("input",{type:"range",min:"1",max:"10",value:h.overall,onChange:e=>g({...h,overall:parseInt(e.target.value)}),className:"w-full"}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:h.overall})]}),(0,t.jsx)("button",{type:"submit",disabled:m,className:"w-full bg-yellow-500 text-white py-2 px-4 rounded hover:bg-yellow-600 disabled:opacity-50",children:m?"Submitting...":"Submit Post"})]})}function NewPost(){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.Z,{}),(0,t.jsxs)("main",{className:"max-w-4xl mx-auto p-4",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Share Your Fries"}),(0,t.jsx)(PostForm,{})]})]})}},1163:function(e,s,a){e.exports=a(9974)}},function(e){e.O(0,[978,551,946,774,888,179],function(){return e(e.s=5702)}),_N_E=e.O()}]);