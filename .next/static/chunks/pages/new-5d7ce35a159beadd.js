(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[971],{5702:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/new",function(){return a(4791)}])},3247:function(e,t,a){"use strict";a.d(t,{Z:function(){return Navbar}});var l=a(5893),s=a(1664),n=a.n(s);function Navbar(){return(0,l.jsxs)("nav",{className:"p-4 border-b flex justify-between items-center",children:[(0,l.jsx)(n(),{href:"/",className:"text-xl font-bold",children:"OnlyFries"}),(0,l.jsxs)("div",{className:"flex gap-4",children:[(0,l.jsx)(n(),{href:"/",className:"hover:text-yellow-500",children:"Home"}),(0,l.jsx)(n(),{href:"/new",className:"hover:text-yellow-500",children:"New Post"})]})]})}},2497:function(e,t,a){"use strict";a.d(t,{db:function(){return d},t:function(){return u}});var l=a(3977),s=a(2370),n=a(9828),r=a(9362),o=a(9744);let i={apiKey:"AIzaSyBt9tzisH1lRcivPB4wh7D2WzHxgkp9v4Y",authDomain:"onlyfries-app.firebaseapp.com",projectId:"onlyfries-app",storageBucket:"onlyfries-app.firebasestorage.app",messagingSenderId:"933935883918",appId:"1:933935883918:web:66bb3a09f5981791918bdf",measurementId:"G-RWD456SCHN"},c=(0,l.ZF)(i),d=(0,n.ad)(c,"onlyfries-app");(0,s.v0)(c);let u=(0,r.cF)(c);(0,o.Gb)().then(e=>e&&(0,o.IH)(c)),console.log("Firebase initialized with config:",{projectId:i.projectId,authDomain:i.authDomain})},4791:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return NewPost}});var l=a(5893),s=a(3247),n=a(7294),r=a(2497),o=a(9362),i=a(9828),c=a(1163);function PostForm(){let[e,t]=(0,n.useState)(null),[a,s]=(0,n.useState)(""),[d,u]=(0,n.useState)(!1),[m,h]=(0,n.useState)(""),[p,g]=(0,n.useState)(!1),[b,x]=(0,n.useState)({locationName:"",menuName:"",types:[],description:"",length:0,thickness:0,crispiness:0,saltiness:0,darkness:0,overall:0}),[f,v]=(0,n.useState)([]),[w,y]=(0,n.useState)(!1),N=(0,n.useRef)(null),j=(0,c.useRouter)(),k={"Classic Styles":[{value:"classic",label:"Classic"},{value:"shoestring",label:"Shoestring"},{value:"steak-cut",label:"Steak Cut"},{value:"home-style",label:"Home Style"},{value:"skin-on",label:"Skin-On"}],"Specialty Cuts":[{value:"waffle",label:"Waffle Style"},{value:"crinkle-cut",label:"Crinkle Cut"},{value:"tornado",label:"Tornado"},{value:"curly",label:"Curly"},{value:"wavy",label:"Wavy"}],"Alternative Fries":[{value:"sweet-potato",label:"Sweet Potato"},{value:"hash-brown",label:"Hash Brown"},{value:"non-potato",label:"Non-Potato"},{value:"tater-tots",label:"Tater Tots"},{value:"polenta",label:"Polenta Fries"}],"Flavor Profiles":[{value:"spiced",label:"Spiced"},{value:"loaded",label:"Loaded"},{value:"seasoned",label:"Seasoned"},{value:"garlic",label:"Garlic"},{value:"truffle",label:"Truffle"}]},S=Object.values(k).flat(),[L,C]=(0,n.useState)(""),[P,T]=(0,n.useState)(null),addTag=e=>{b.types.includes(e.value)||x(t=>({...t,types:[...t.types,e.value]})),C(""),y(!1)},removeTag=e=>{x(t=>({...t,types:t.types.filter(t=>t!==e)}))};(0,n.useEffect)(()=>{if(window.google){let e=new window.google.maps.LatLngBounds(new window.google.maps.LatLng(40.4774,-74.2591),new window.google.maps.LatLng(40.9176,-73.7004)),t=new window.google.maps.places.Autocomplete(N.current,{types:["establishment"],bounds:e,strictBounds:!0});t.addListener("place_changed",()=>{let e=t.getPlace();e.name&&(x(t=>({...t,locationName:e.name})),y(!1))})}},[]);let D=(0,n.useRef)(null),uploadImage=async e=>{let t=Date.now(),a=e.name.replace(/[^a-zA-Z0-9.]/g,"_").toLowerCase(),l="fries/".concat(t,"_").concat(a);console.log("Uploading image to:",l);let s=(0,o.iH)(r.t,l),n={contentType:e.type,customMetadata:{originalName:e.name,uploadTime:new Date().toISOString()}};try{let t=await (0,o.KV)(s,e,n);console.log("Upload successful:",t);let a=await (0,o.Jt)(t.ref);return console.log("Download URL:",a),a}catch(e){throw console.error("Upload error:",e),e}},handleSubmit=async t=>{if(t.preventDefault(),g(!0),!e){h("Please select an image");return}u(!0),h("");try{console.log("Starting upload process...");let t=await uploadImage(e),a={locationName:b.locationName.trim(),menuName:b.menuName.trim(),types:b.types.map(e=>k["Classic Styles"].find(t=>t.value===e)||k["Specialty Cuts"].find(t=>t.value===e)||k["Alternative Fries"].find(t=>t.value===e)||k["Flavor Profiles"].find(t=>t.value===e)).map(e=>e.value),description:b.description.trim(),length:Number(b.length),thickness:Number(b.thickness),crispiness:Number(b.crispiness),saltiness:Number(b.saltiness),darkness:Number(b.darkness),overall:Number(b.overall),imageUrl:t,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};if(!a.locationName||0===a.types.length||0===a.length||0===a.thickness||0===a.crispiness||0===a.saltiness||0===a.darkness||0===a.overall)throw Error("Please fill in all required fields");console.log("Saving to Firestore:",a);try{let e=(0,i.hJ)(r.db,"posts"),t=await (0,i.ET)(e,a);console.log("Document written with ID:",t.id),j.push("/")}catch(e){throw console.error("Firestore write error:",{code:e.code,message:e.message,details:e}),h("Error saving post: "+(e.message||"Unknown error")),e}}catch(e){console.error("Submission error:",e),h(e.message||"Error submitting post")}finally{u(!1)}},RatingScale=e=>{let{label:t,value:a,onChange:s,leftLabel:n,rightLabel:r}=e;return(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsxs)("label",{className:"block text-sm font-medium mb-2",children:[t," ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)("span",{className:"text-sm text-gray-500 w-16",children:n}),(0,l.jsx)("div",{className:"flex-1 flex justify-center gap-1",children:[1,2,3,4,5,6,7,8,9,10].map(e=>(0,l.jsx)("button",{type:"button",onClick:()=>s(e),className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium transition-colors\n                ".concat(a===e?"bg-yellow-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:e},e))}),(0,l.jsx)("span",{className:"text-sm text-gray-500 w-16 text-right",children:r})]}),p&&0===a&&(0,l.jsx)("p",{className:"text-sm text-red-500 mt-1",children:"Please select a rating"})]})};return(0,l.jsxs)("form",{onSubmit:handleSubmit,className:"max-w-2xl mx-auto p-4",children:[m&&(0,l.jsx)("div",{className:"mb-8 p-4 bg-red-100 text-red-700 rounded",children:m}),(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["Fries Image ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("input",{ref:D,type:"file",accept:"image/*",capture:"environment",onChange:e=>{let a=e.target.files[0];if(a){if(!a.type.startsWith("image/")){h("Please upload an image file");return}if(a.size>5242880){h("Image size should be less than 5MB");return}t(a),s(URL.createObjectURL(a)),h("")}},className:"hidden",required:!0}),a?(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("img",{src:a,alt:"Preview",className:"w-full h-64 object-cover rounded-lg"}),(0,l.jsx)("button",{type:"button",onClick:()=>{t(null),s(""),D.current&&(D.current.value="")},className:"absolute top-2 right-2 bg-white/80 hover:bg-white text-gray-800 rounded-full p-2 shadow-lg",children:(0,l.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),(0,l.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=D.current)||void 0===e?void 0:e.click()},className:"absolute bottom-2 right-2 bg-white/80 hover:bg-white text-gray-800 rounded-full p-2 shadow-lg",children:(0,l.jsxs)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})})]}):(0,l.jsx)("div",{onClick:()=>{var e;return null===(e=D.current)||void 0===e?void 0:e.click()},className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center cursor-pointer hover:border-yellow-500 transition-colors",children:(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,l.jsxs)("svg",{className:"w-12 h-12 text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Tap to take a photo or upload an image"}),(0,l.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"PNG, JPG up to 5MB"})]})})]})]}),(0,l.jsxs)("div",{className:"mb-8 relative",children:[(0,l.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["Location Name ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsx)("input",{ref:N,type:"text",value:b.locationName,onChange:e=>{x({...b,locationName:e.target.value}),y(!0)},className:"w-full p-2 border rounded",placeholder:"Type to search",required:!0})]}),(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Name on Menu (Optional)"}),(0,l.jsx)("input",{type:"text",value:b.menuName,onChange:e=>x({...b,menuName:e.target.value}),className:"w-full p-2 border rounded",placeholder:"Crazy loaded truffle fries"}),(0,l.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"If establishment has multiple types of fries on their menu"})]}),(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["Type ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2 p-2 border rounded min-h-[42px]",children:[b.types.map(e=>{let t=S.find(t=>t.value===e);return(0,l.jsxs)("span",{className:"flex items-center gap-1 px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm",children:[null==t?void 0:t.label,(0,l.jsx)("button",{type:"button",onClick:()=>removeTag(e),className:"ml-1 text-yellow-600 hover:text-yellow-800",children:"\xd7"})]},e)}),(0,l.jsxs)("div",{className:"relative flex-1",children:[(0,l.jsx)("input",{ref:P,type:"text",value:L,onChange:e=>{let t=e.target.value;if(C(t),t){let e=S.filter(e=>e.label.toLowerCase().includes(t.toLowerCase())&&!b.types.includes(e.value));v(e),y(!0)}else v([]),y(!1)},onKeyDown:e=>{"Enter"===e.key&&L&&f.length>0?(e.preventDefault(),addTag(f[0])):"Backspace"===e.key&&!L&&b.types.length>0&&removeTag(b.types[b.types.length-1])},onFocus:()=>y(!0),className:"w-full outline-none",placeholder:0===b.types.length?"Type to select tags":""}),w&&f.length>0&&(0,l.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-white border rounded shadow-lg",children:f.map(e=>(0,l.jsx)("div",{onClick:()=>addTag(e),className:"px-4 py-2 hover:bg-gray-100 cursor-pointer",children:e.label},e.value))})]})]})]}),(0,l.jsx)(RatingScale,{label:"Length",value:b.length,onChange:e=>x({...b,length:e}),leftLabel:"Short",rightLabel:"Long"}),(0,l.jsx)(RatingScale,{label:"Thickness",value:b.thickness,onChange:e=>x({...b,thickness:e}),leftLabel:"Thin",rightLabel:"Thick"}),(0,l.jsx)(RatingScale,{label:"Crispiness",value:b.crispiness,onChange:e=>x({...b,crispiness:e}),leftLabel:"Soft",rightLabel:"Crispy"}),(0,l.jsx)(RatingScale,{label:"Saltiness",value:b.saltiness,onChange:e=>x({...b,saltiness:e}),leftLabel:"Mild",rightLabel:"Salty"}),(0,l.jsx)(RatingScale,{label:"Darkness",value:b.darkness,onChange:e=>x({...b,darkness:e}),leftLabel:"Light",rightLabel:"Dark"}),(0,l.jsx)(RatingScale,{label:"Overall Rating",value:b.overall,onChange:e=>x({...b,overall:e}),leftLabel:"Poor",rightLabel:"Excellent"}),(0,l.jsxs)("div",{className:"mt-12 mb-8",children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Comment (Optional)"}),(0,l.jsx)("textarea",{value:b.description,onChange:e=>x({...b,description:e.target.value}),className:"w-full p-2 border rounded",rows:"3",placeholder:"Describe the fries, any special seasonings, etc."})]}),(0,l.jsx)("button",{type:"submit",disabled:d,className:"w-full bg-yellow-500 text-white py-3 px-4 rounded hover:bg-yellow-600 disabled:opacity-50",children:d?"Submitting...":"Submit Post"})]})}function NewPost(){return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.Z,{}),(0,l.jsxs)("main",{className:"max-w-4xl mx-auto p-4",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Share Your Fries"}),(0,l.jsx)(PostForm,{})]})]})}},1163:function(e,t,a){e.exports=a(9974)}},function(e){e.O(0,[978,551,946,774,888,179],function(){return e(e.s=5702)}),_N_E=e.O()}]);